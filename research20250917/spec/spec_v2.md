# 図書貸出システム 仕様 v2

## 決定事項

- 貸出期間（通常本）: 固定14日。
- 重複貸出: 同じ本を借りようとした場合はエラーとする。
- 人気本の貸出期間: 固定7日（通常本より短い）。

## TODO（未決事項）

### 前提とユーザ

- [ ] ユーザ登録が必要ですか？
- [ ] 認証済みユーザのみ貸出可能にしますか？
- [ ] ユーザ種別（一般／職員など）で貸出ルールを分けますか？
- [ ] 未成年など特定属性で追加制限を設けますか？
- [ ] ゲスト（未登録）に閲覧のみを許可しますか？

### 本の識別と対象範囲

- [ ] 「同じ本」はISBN（版を含む）で判定しますか？
- [ ] 同一タイトルの別版は「同じ本」と見なしますか？
- [ ] 複本（同一ISBNの別コピー）は別物として同時貸出可能にしますか？
- [ ] 電子書籍も貸出対象に含めますか？
- [ ] 館内資料（参考図書など）を貸出対象から除外しますか？

### 貸出ルール（上限・重複・期間）

- [ ] 1ユーザあたりの同時貸出冊数に上限を設けますか？
- [ ] 同一ユーザが同じ本を同時に複数コピー借りるのを禁止しますか？
- [ ] 貸出期間はユーザ種別や本の種別で変動させますか？
- [ ] 返却期限は貸出手続き日からの暦日で計算しますか（営業日換算はしませんか）？

### 延長・予約

- [ ] 期限延長（更新）を許可しますか？
- [ ] 延長回数に上限を設けますか？
- [ ] 予約待ちがある場合は延長を禁止しますか？
- [ ] 予約機能（待ち行列）を提供しますか？
- [ ] 予約取り置きの有効期限を設定しますか？

### 返却・延滞・罰則

- [ ] 返却は営業時間外（ブックポスト等）でも受け付けますか？
- [ ] 延滞時に自動で貸出停止期間を課しますか？
- [ ] 延滞料金（罰金）を課しますか？
- [ ] 大幅な延滞時に強制弁償扱いとしますか？
- [ ] 紛失・破損時の弁償処理フローをシステムで扱いますか？

### 人気本の特別扱い

- [ ] 人気本の判定を自動（貸出回数・予約数等）で行いますか？
- [ ] 人気本は延長不可にしますか？
- [ ] 人気本の同時貸出冊数をより厳しく制限しますか？
- [ ] 人気本の予約上限（待ち人数）を設定しますか？

### エラーハンドリング・通知

- [ ] 業務ルール違反時は処理をブロックしてエラーにしますか（警告のみではなく）？
- [ ] エラーメッセージをユーザ向けに表示しますか？
- [ ] 通知（貸出・期限接近・延滞・予約到来）をメールで送信しますか？
- [ ] メール以外（SMS／プッシュ通知）も使用しますか？
- [ ] APIがある場合、エラーコード体系を定義して返しますか？

### 運用・監査・データ

- [ ] 休館日設定を考慮（期限繰り上げ／繰り下げ）しますか？
- [ ] 管理者が貸出状態を手動で修正できるようにしますか？
- [ ] 監査ログ（誰が何をいつしたか）を記録しますか？
- [ ] 個人情報の保存を最小化（不要データは保存しない）しますか？

