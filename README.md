# Java LLM Spec Research
本研究では、仕様書駆動開発における曖昧性解消とLLMコード生成の関係を調査する。

## ディレクトリ構成
- spec/        # 仕様書
- constraints/ # 不変の制約
- src/         # 修正版コード
- notes/       # 実験ログ
- scripts/     # 自動化スクリプト

## 仮説
- 仕様書に曖昧な表現が多いと、LLMによるコード生成では修正工数が増える。
- 曖昧性を解消して仕様を進化させると、生成コードの修正率が低下し、テスト緑化までの時間も短縮される。

## 進捗
- Day1: 図書貸出システムの仕様 v1 を作成。曖昧な表現（「適切に」「十分に」「特別に」など）を意図的に含め、LLMにより曖昧性質問リストを生成。回答3件を反映し、spec_v2.md を作成。
- Day2: 仕様 v2 から JUnit テスト (3件) を生成。app/src/test/java/ に配置し、Gradleで実行。全件赤テストとなり、赤テスト資産を確保。
- Day3: 骨格コード (BookLendingService, User, Book) を生成し、app/src/main/java/ に配置。コンパイル成功、テストは依然赤。仕様→テスト→コードの流れが接続された。
- Day4: BookLendingServiceTest を実装クラスに切り替え、通常本14日テストを緑化する予定だったが、人気本7日も同時に緑化。これは骨格コード生成段階で7日の定数が含まれていたため。研究的には「LLMが意図せず仕様を満たすリスク」として記録。
- Day5: 設計整合を取るため LoanRepository を共有契約として導入。BookLendingService に依存注入を実施し、重複貸出テストを緑化。仕様 v2 の全テストが緑化完了。
- Day6: Day1〜Day5 の振り返りを実施。想定外の挙動（人気本7日の予定外緑化、設計整合の必要性）を整理。曖昧性がコード生成段階で過剰実装として現れるリスクや、テストと実装の不整合が発生するケースを確認。次フェーズ（仕様 v3 導入）の方針を検討。

## 今後の予定
- Day4以降で赤テストを1件ずつ緑化し、修正行数と所要時間を計測。
- 曖昧性スコアと修正率・Time-to-Green の相関を分析。
- 研究ログは notes/daily.md と chatlogs/ に記録。
- Day6: Day1〜Day5 の振り返りを実施。想定外の挙動（予定外の緑化、設計整合の必要性）を分析し、次フェーズ（仕様 v3）の導入方針を決定。